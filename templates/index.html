<!DOCTYPE html>
{% load staticfiles %}
{% load i18n %}

<html class="theme-next mist use-motion">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta http-equiv="Cache-Control" content="no-transform">
        <meta http-equiv="Cache-Control" content="no-siteapp">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">

{#        <script type="text/javascript" src="{% static 'js/love.js' %}"></script>#}
        <script type="text/javascript" id="hexo.configuration">
            var NexT=window.NexT||{},CONFIG={scheme:"Mist",sidebar:{position:"left",display:"post"},fancybox:!0,motion:!0,duoshuo:{userId:void 0,author:"博主"}}
        </script>
        <script type="text/javascript" src="{% static 'js/particle.js' %}"></script>
        <script src="{% static 'js/embed.dist.js' %}" async=""></script>
        <script src="{% static 'js/pace.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/index.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/fastclick.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/jquery.lazyload.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/velocity.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/velocity.ui.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/jquery.fancybox.pack.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/utils.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/motion.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/bootstrap.js' %}"></script>

        {% block custom_js %}{% endblock %}
        {% block custom_css %}{% endblock %}

        <link href="/static/css/pace-theme-flash.css" rel="stylesheet">
        <link rel="shortcut icon" href="{% static 'icon/github.ico' %}">
        <link href="{% static 'css/jquery.fancybox.css' %}" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
        <link href="{% static 'css/font-awesome.min.css' %}" rel="stylesheet" type="text/css">
        <link href="{% static 'css/main.css' %}" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="{% static 'css/header-style.css' %}">

        <title> MING's Blog - 城南花开</title>
    </head>

    <body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans" class="  pace-done">
        <!-- top是顶部 -->
        <div class="headwrap" {% if 'article' in request.path %}style="position: absolute;top:-30px"{% endif %}>
            <div class="head">
                <div class="tel">
                </div>

                {% if not request.user.is_authenticated %}
                <!-- 未登录显示 -->
                <div class="userwrap" >
                    <button type="button" onclick="window.location.href='{% url 'user:login' %}'" style="height: 26px; color: #080808;width: 60px;margin-top: 1px;border: 0;line-height: 26px;font-size: 10px!important;">登录</button>
                    <button type="button" onclick="window.location.href='{% url 'user:register' %}'" style="height: 26px; color: #080808;width: 60px;margin-top: 1px;border: 0;line-height: 26px;font-size: 10px!important;">注册</button>
                </div>
                {% else %}
                <!-- 登录显示 -->
                <div class="userwrap">
                    <div class="user">
                        <div class="userHead">
                            <img src="{{ MEDIA_URL }}{{ request.user.image }}" alt="">
                        </div>
                        <div class="userName">{{ request.user.nick_name }}<i></i></div>
                    </div>
                    <div class="userInfo">
                        <div class="clearfix">
                            <div class="infoHead">
                                <img src="{{ MEDIA_URL }}{{ request.user.image }}" alt="">
                            </div>
                            <div class="infoName">
                                <span class="name">{{ request.user.nick_name }}</span>
                                <span class="account">{{ request.user.username }}</span>
                            </div>
                        </div>
                        <div class="btnWrap">
                            <a href="{% url 'user:upload' %}" class="btn1 btnGo">进入修改头像</a>
                            <a href="{% url 'user:logout' %}" class="btn1 btnOut">退出</a>
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
        <div class="pace  pace-inactive">
            <div class="pace-progress" data-progress-text="100%" data-progress="99" style="transform: translate3d(100%, 0px, 0px);">
                <div class="pace-progress-inner"></div>
            </div>
            <div class="pace-activity"></div>
        </div>



        <div class="container one-collumn sidebar-position-left page-home">
            <div class="headband"></div>
            <!-- 顶部导航栏 -->
            <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
                <div class="header-inner">
                    <div class="site-meta">
                        <div class="custom-logo-site-title">
                            <a href="{% url 'homepage' %}" class="brand" rel="start" style="opacity: 1;">
                                <span class="logo-line-before">
                                    <i class="" style="transform: translateX(100%);"></i>
                                </span>
                                <span class="site-title" style="opacity: 1; top: 0px;">MING's Blog</span>
                                <span class="logo-line-after">
                                    <i class="" style="transform: translateX(-100%);"></i>
                                </span>
                            </a>
                        </div>

                        <p class="site-subtitle" style="opacity: 1; top: 0px;">
                            那一年，城南花开.......
                        </p>
                    </div>

                    <div class="site-nav-toggle">
                        <button>
                            <span class="btn-bar"></span>
                            <span class="btn-bar"></span>
                            <span class="btn-bar"></span>
                        </button>
                    </div>
                    <nav class="site-nav">
                        <ul id="menu" class="menu">
                            <li class="menu-item menu-item-count" style="opacity: 1; transform: translateY(0px);"><a href="{% url 'count' %}" rel="section"><i class="menu-item-icon fa fa-book"></i>
                                <br> 阅读排行</a>
                            </li>
                            <li class="menu-item menu-item-collect_url" style="opacity: 1; transform: translateY(0px);"><a href="{% url 'secweb' %}" rel="section"><i class="menu-item-icon fa fa-internet-explorer"></i>
                                <br> 安全导航</a>
                            </li>
                            <li class="menu-item menu-item-message" style="opacity: 1; transform: translateY(0px);"><a href="{% url 'message' %}" rel="section"><i class="menu-item-icon fa fa-comments"></i>
                                <br> 留言</a>
                            </li>
                            <li class="menu-item menu-item-archives" style="opacity: 1; transform: translateY(0px);"><a href="{% url 'archive' %}" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i>
                                <br> 归档</a>
                            </li>
                            <li class="menu-item menu-item-categories" style="opacity: 1; transform: translateY(0px);"><a href="{% url 'category' %}" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i>
                                <br> 分类</a>
                            </li>
                            <li class="menu-item menu-item-tags" style="opacity: 1; transform: translateY(0px);"><a href="{% url 'tag' %}" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i>
                                <br> 标签</a>
                            </li>
                            <!-- 书籍
                            <li class="menu-item menu-item-book" style="opacity: 1; transform: translateY(0px);"><a href="https://book.thief.one/" rel="section"><i class="menu-item-icon fa fa-fw fa-question-circle"></i>
                                <br> Book</a>
                            </li>
                            -->
                            <!-- 搜索
                            <li class="menu-item menu-item-search" style="opacity: 1; transform: translateY(0px);">
                                <a href="javascript:;" class="popup-trigger">
                                    <i class="menu-item-icon fa fa-search fa-fw"></i>
                                <br> 搜索</a>
                            </li>
                            -->
                        </ul>

                        <div class="site-search">
                            <div class="popup">
                                <span class="search-icon fa fa-search"></span>
                                <input type="text" id="local-search-input">
                                <div id="local-search-result"></div>
                                <span class="popup-btn-close">close</span>
                            </div>
                        </div>
                    </nav>
                </div>
            </header>
            {% block main %}
                <!--主体部分-->
                <main id="main" class="main">
                <div class="main-inner">
                    <div class="content-wrap">
                        <div id="content" class="content">
                            <section id="posts" class="posts-expand">
                                <!-- 文章列表页 -->
                                {% for article in articles.object_list %}
                                <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article" style="opacity: 1; display: block; transform: translateY(0px);">
                                    <header class="post-header">
                                        <h1 class="post-title" itemprop="name headline">
                                            <a class="post-title-link" href="{% url 'article' title=article.title is_com=0 %}" itemprop="url">
                                                {{ article.title }}
                                            </a>
                                        </h1>
                                        <div class="post-meta">
                                            <span class="post-time">
                                                <span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span>
                                                <span class="post-meta-item-text">发表于</span>
                                                <time itemprop="dateCreated" datetime="{{ article.add_time }}" content="{{ article.add_time }}">{{ article.add_time }}</time></span>
                                            <span class="post-category">&nbsp; | &nbsp;
                                                <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span>
                                                <span class="post-meta-item-text">分类于</span>
                                                <span itemprop="about" itemscope="" itemtype="https://schema.org/Thing">
                                                    <a href="https://thief.one/categories/%E7%88%AC%E8%99%AB%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index">
                                                    <span itemprop="name">{{ article.category }}</span>
                                                    </a>
                                                </span>
                                            </span>
                                            <span id="{{ article.id }}" class="leancloud_visitors" data-flag-title="{{ article.title }}">&nbsp; | &nbsp;
                                                <span class="post-meta-item-icon">
                                                    <i class="fa fa-eye"></i>
                                                </span>
                                                <span class="post-meta-item-text">热度</span>
                                                <span class="leancloud-visitors-count">{{ article.view_nums }}</span>
                                                <span>℃</span>
                                            </span>
                                        </div>
                                    </header>
                                    <div class="post-body" itemprop="articleBody">
                                        <p></p>
                                        <blockquote class="blockquote-center">
                                            {% autoescape off %}
                                            {{ article.quote }}
                                            {% endautoescape %}
                                        </blockquote>
                                        <br>
                                        {% autoescape off %}
                                        &emsp;&emsp;{{ article.abstract }}
                                        {% endautoescape %}
                                        <br>
                                        <div class="post-more-link text-center"> <a class="btn" href="{% url 'article' title=article.title is_com=0 %}" rel="contents">阅读全文 »</a>
                                        </div>
                                    </div>
                                    <div>

                                    </div>
                                    <div></div>
                                    <div></div>
                                    <footer class="post-footer">
                                        <div class="post-eof">
                        </div>
                                    </footer>
                                </article>
                                {% endfor %}
                            </section>

                            <!-- 分页 -->
                            <nav class="pagination">
                                {% if articles.has_previous %}
                                    <span class="page-number">
                                        <a href="?{{ articles.previous_page_number.querystring }}" class="prev">&lsaquo;&lsaquo; {% trans "前一页" %}
                                        </a>
                                    </span>
                                {% endif %}
                                {% for page in articles.pages %}
                                    {% if page %}
                                        {% ifequal page articles.number %}
                                            <span class="page-number current">
                                                <a href="?{{ page.querystring }}">{{ page }}</a>
                                            </span>
                                        {% else %}
                                            <span class="page-number">
                                                <a href="?{{ page.querystring }}" class="page">{{ page }}</a>
                                            </span>
                                        {% endifequal %}
                                    {% else %}
                                        <span class="page-number"><a href="">1</a></span>
                                    {% endif %}
                                {% endfor %}
                                {% if articles.has_next %}
                                    <span class="page-number">
                                        <a href="?{{ articles.next_page_number.querystring }}" class="next">
                                            {% trans "后一页" %} &rsaquo;&rsaquo;
                                        </a>
                                    </span>
                                {% endif %}
                            <!--
                                <span class="page-number current">1</span>
                                <a class="page-number" href="https://thief.one/page/2/">2</a>
                                <span class="space">…</span>
                                <a class="page-number" href="https://thief.one/page/5/">5</a>
                                <a class="extend next" rel="next" href="https://thief.one/page/2/">
                                    <i class="fa fa-angle-right"></i>
                                </a>
                            -->
                            </nav>
                        </div>
                    </div>

                    <div class="sidebar-toggle">
                    <div class="sidebar-toggle-line-wrap">
                        <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
                        <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
                        <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
                    </div>
                    </div>
                <!-- 侧边栏 -->
                {% block site_state %}
                    <aside id="sidebar" class="sidebar">
                    <div class="sidebar-inner">
                        <section class="site-overview sidebar-panel sidebar-panel-active">
                        <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                            <img class="site-author-image" itemprop="image" src="{{ MEDIA_URL }}{{ author.image }}" alt="MING">
                            <p class="site-author-name" itemprop="name">{{ author.username }}</p>
                            <p class="site-description motion-element" itemprop="description">城南花开</p>
                        </div>
                        <nav class="site-state motion-element">
                            <div class="site-state-item site-state-posts">
                                <a href="{% url "archive" %}">
                                    <span class="site-state-item-count">{{ article_nums }}</span>
                                    <span class="site-state-item-name">日志</span>
                                </a>
                            </div>

                            <div class="site-state-item site-state-categories">
                                <a href="{% url 'category' %}">
                                    <span class="site-state-item-count">{{ cat_nums }}</span>
                                    <span class="site-state-item-name">分类</span>
                                </a>
                            </div>

                            <div class="site-state-item site-state-tags">
                                <a href="{% url 'tag' %}">
                                    <span class="site-state-item-count">{{ tag_nums }}</span>
                                    <span class="site-state-item-name">标签</span>
                                </a>
                            </div>
                        </nav>
                        <div class="feed-link motion-element">
                            <a href="#" rel="alternate">
                            <i class="fa fa-rss"></i>
                            RSS</a>
                        </div>
                        <div class="links-of-author motion-element">
                            {% for site in sites %}
                            <span class="links-of-author-item">
                                <a href="{{ site.link }}" rel="external nofollow" target="_blank" title="{{ site.name }}">
                                    <i class="fa fa-fw fa-globe">
                                    </i> {{ site.name }}</a>
                            </span>
                            {% endfor %}
                        </div>
                        <div class="cc-license motion-element" itemprop="license">
                            <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank" rel="external nofollow">
                                <img src="{% static 'svg/cc-by-nc-sa.svg' %}" alt="Creative Commons">
                            </a>
                        </div>
                        <div class="links-of-blogroll motion-element links-of-blogroll-inline">

                            <div class="links-of-blogroll-title"><i class="fa fa-fw fa-globe"></i> 友情链接</div>
                            <ul class="links-of-blogroll-list">
                            {% for link in links %}
                                <li class="links-of-blogroll-item">
                                    <a href="{{ link.link }}" title="{{ link.name }}" target="_blank">{{ link.name }}</a>
                                </li>
                            {% endfor %}
                            </ul>
                        </div>
                        </section>
                    </div>
                    </aside>
                {% endblock %}
                </div>
            </main>
            {% endblock %}

            <!--底部-->
            {% block footer %}
                <footer id="footer" class="footer">
                    <div class="footer-inner">
                        <div class="copyright"> © 2017 -
                            <span itemprop="copyrightYear">2020</span>
                            <span class="with-love">
                                <i class="fa fa-heart"></i>
                            </span>
                            <span class="author" itemprop="copyrightHolder">MING</span>
                        </div>

                        <div class="busuanzi-count">
                            <script async="" src="{% static 'js/busuanzi.pure.mini.js' %}"></script>
                            <!--
                            <span class="site-uv">本站访客数
                                <i class="fa fa-user"></i>
                                <span class="busuanzi-value" id="busuanzi_value_site_uv">42309</span>人次
                            </span>
                            -->

                            <span class="site-pv">本站总访问量
                                <i class="fa fa-eye"></i>
                                <span>{{ visit_nums }}</span>次
                            </span>
                        </div>
                    </div>
                </footer>
            {% endblock %}
            <!-- 回到顶部按钮 -->
            <div class="back-to-top back-to-top-on">
                <i class="fa fa-arrow-up"></i>
            </div>
        </div>

        <!-- 点击搜索代码 -->
        <script type="text/javascript">
            function proceedsearch() {
                $("body").append('<div class="popoverlay">').css("overflow", "hidden"), $(".popup").toggle()
            }
            var isfetched = !1,
                search_path = "search.xml";
            0 == search_path.length && (search_path = "search.xml");
            var path = "/" + search_path,
                searchFunc = function(e, t, a) {
                    "use strict";
                    $.ajax({
                        url: e,
                        dataType: "xml",
                        async: !0,
                        success: function(e) {
                            isfetched = !0, $(".popup").detach().appendTo(".header-inner");
                            var r = $("entry", e).map(function() {
                                return {
                                    title: $("title", this).text(),
                                    content: $("content", this).text(),
                                    url: $("url", this).text()
                                }
                            }).get(),
                                c = document.getElementById(t),
                                s = document.getElementById(a);
                            c.addEventListener("input", function() {
                                var e = 0,
                                    t = '<ul class="search-result-list">',
                                    a = this.value.trim().toLowerCase().split(/[\s\-]+/);
                                s.innerHTML = "", this.value.trim().length > 1 && r.forEach(function(r) {
                                    var c = !0,
                                        s = r.title.trim().toLowerCase(),
                                        n = r.content.trim().replace(/<[^>]+>/g, "").toLowerCase(),
                                        i = r.url,
                                        o = -1,
                                        l = -1,
                                        p = -1;
                                    if ("" != s && "" != n && a.forEach(function(e, t) {
                                        o = s.indexOf(e), l = n.indexOf(e), o < 0 && l < 0 ? c = !1 : (l < 0 && (l = 0), 0 == t && (p = l))
                                    }), c) {
                                        e += 1, t += "<li><a href='" + i + "' class='search-result-title'>" + s + "</a>";
                                        var h = r.content.trim().replace(/<[^>]+>/g, "");
                                        if (p >= 0) {
                                            var u = p - 20,
                                                d = p + 80;
                                            u < 0 && (u = 0), 0 == u && (d = 50), d > h.length && (d = h.length);
                                            var f = h.substring(u, d);
                                            a.forEach(function(e) {
                                                var t = new RegExp(e, "gi");
                                                f = f.replace(t, '<b class="search-keyword">' + e + "</b>")
                                            }), t += '<p class="search-result">' + f + "...</p>"
                                        }
                                        t += "</li>"
                                    }
                                }), t += "</ul>", 0 == e && (t = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'), "" == a && (t = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'), s.innerHTML = t
                            }), proceedsearch()
                        }
                    })
                };
            $(".popup-trigger").click(function(e) {
                e.stopPropagation(), 0 == isfetched ? searchFunc(path, "local-search-input", "local-search-result") : proceedsearch()
            }), $(".popup-btn-close").click(function(e) {
                $(".popup").hide(), $(".popoverlay").remove(), $("body").css("overflow", "")
            }), $(".popup").click(function(e) {
                e.stopPropagation()
            })
        </script>
    </body>
</html>